<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="../data/index/logobgr.png" type="image/icon type">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yantrik Blog</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css" integrity="sha256-XoaMnoYC5TH6/+ihMEnospgm0J1PM/nioxbOUdnM8HY=" crossorigin="anonymous">
    
    <link rel="stylesheet" href="../css/iblog.css">
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

    <script>
        function showmenu(){
            var menbar = document.querySelector(".mnoptions");
            const cs = window.getComputedStyle(menbar).display;
            if (cs === "flex"){
                menbar.style.display = "none";
                const btn = document.querySelector(".ham");
                btn.innerHTML = `<a onclick="showmenu()"><i class="fa fa-bars" aria-hidden="true"></i></a>`
            }
            else if (cs === "none"){
                menbar.style.display = "flex";
                const btn = document.querySelector(".ham");
                btn.innerHTML = `<a onclick="showmenu()"><i class="fa fa-times" aria-hidden="true"></i></a>`
            }

        }
        
    </script>
    <div class="wrapper">
        <div class="innerwrapper">
            <header>
                <a href="../index.html"><img src="../data/index/logobgr.png" alt=""></a>
                
                <ul class="mnoptions">
                    <li>
                        <a href="../index.html">Home</a>
                    </li>
                    <li>
                        <a href="/pages/blog.html">Blogs</a>
                    </li>
                    <li>
                        <a href="/pages/events.html">Events</a>
                    </li>
                    <li>
                        <a href="/pages/gallery.html">Gallery</a>
                    </li>
                    <li>
                        <a href="/pages/team.html">Team</a>
                    </li>   
                </ul>
                <div class="ham"><a onclick="showmenu()"><i class="fa fa-bars" aria-hidden="true"></i></a></div>
            </header>
            <main>

                <div id="preloader">
                    <div class="text">Just a moment</div>
                    <div class="boxes">
                        <div class="box">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <div class="box">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <div class="box">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                        <div class="box">
                            <div></div>
                            <div></div>
                            <div></div>
                            <div></div>
                        </div>
                    </div>
                    
                   
                </div>

                <div class="content">
                    <div class="head">
                        <p id="title"></p>
                        <div id="bgimgbox">
                            <img id="bgimg" alt="Background Image">
                        </div>
                        <blockquote id="description"></blockquote>
                        <!-- <p id="description"></p> -->
                    </div>

                    <div class = "data" id = "data">
                    </div>
                    <div class="author">
                        <div id="authimgbox">
                            <img src="../data/blogs/profile.png" alt="" id="authorimg">
                        </div>
                        <div id="authdata">
                            <h1 id="authorname"></h1>
                            <p id="authordesc"></p>
                        </div>
                    </div>
                    <div id="timestamp"></div>
                </div>
                <!-- <button id="pdfgen">Save pdf</button> -->
            </main>
            
            <footer>
                <div class="wrap">
                    <div class="imgbx">
                        <img src="../data/index/logobgr.png" alt="">
                    </div>
                    
                    <div class="contact">
                        <p>Reach Us On</p>
                        <ul>
                            <li><a href=""><i class="fa fa-discord" aria-hidden="true"></i></a></li>
                            <li><a href=""><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                            <li><a href=""><i class="fa fa-facebook-official" aria-hidden="true"></i></a></li>
                            <li><a href=""><i class="fa fa-youtube-play" aria-hidden="true"></i></a></li>
                            <li><a href=""><i class="fa fa-github" aria-hidden="true"></i></a></li>
                            <li><a href=""><i class="fa fa-wikipedia-w" aria-hidden="true"></i></a></li>
                        </ul>
                    </div>
                    <div class="data">
                        <p><a href="mailto:yantrik_club@students.iitmandi.ac.in"><i class="fa fa-envelope" aria-hidden="true"></i> yantrik_club@students.iitmandi.ac.in</a></p>
                        <p><i class="fa fa-map-marker text-dark p-3"></i> IIT Mandi, <br>Kammand (H.P.)- 175005</p>
                    </div>
                </div>

                <div class="copyright">
                    <p>Â© 2022. YantrikClub-IIT&nbsp;Mandi. All&nbsp;Rights&nbsp;Reserved</p>
                </div>
            </footer>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
        const firebaseConfig = {
          apiKey: "AIzaSyCo5jZ9wyNSP401q5X8-BH-gM7uxUnhuro",
          authDomain: "web2k21-99ffd.firebaseapp.com",
          projectId: "web2k21-99ffd",
          storageBucket: "web2k21-99ffd.appspot.com",
          messagingSenderId: "616040662732",
          appId: "1:616040662732:web:ac36b18f3ccff8c246a469"
        };
        const app = initializeApp(firebaseConfig);

        import {getFirestore,query, where, doc, getDoc,getDocs , setDoc, collection, addDoc,updateDoc, deleteDoc, deleteField} from "https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore.js";
        
        const db = getFirestore();


        let blogid = decodeURI(location.pathname.split("/").pop());

        var bgimg = document.getElementById("bgimg");
        var blogtitle = document.getElementById("title");
        var desc = document.getElementById("description");
        var mdata = document.getElementById("data");
        var authimg = document.getElementById("authorimg");
        var authnm = document.getElementById("authorname");
        var authdesc = document.getElementById("authordesc");
        var tstamp = document.getElementById("timestamp");
        

        var parser = new DOMParser();

        async function loaddata(){
            const data = query(collection(db,"Blogs"),where("UID","==",blogid));
            const docSnap = await getDocs(data);
            if (docSnap.size >0){
                docSnap.forEach(chsnap=>{
                const csnap = chsnap.data();
                bgimg.src = csnap.ImageURLs.sback;
                blogtitle.innerHTML = csnap.Title;
                document.title = csnap.Title;
                desc.innerHTML = csnap.Description;
                mdata.innerHTML = csnap.Data;
                authimg.src = csnap.ImageURLs.sauth;
                authnm.innerHTML = csnap.AuthName;
                authdesc.innerHTML = csnap.Authbio;
                tstamp.innerHTML = csnap.Timestamp;
            })
            }else{
                location.href = "/pages/missing.html";
            }
        }

        window.onload = loaddata;
        
        
        // const pdfbtn = document.getElementById("pdfgen");
        // pdfbtn.addEventListener("click",()=>{
        //     const content = document.getElementById("content");
        //     var opt = {
        //     margin:       1,
        //     filename:     'myfile.pdf',
        //     image:        { type: 'jpeg', quality: 0.98 },
        //     html2canvas:  { scale: 2 },
        //     jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
        //     };

        //     // New Promise-based usage:
        //     html2pdf().set(opt).from(content).save();

        // })

    </script>
    <script src="../js/iblog.js"></script>
</body>
</html>